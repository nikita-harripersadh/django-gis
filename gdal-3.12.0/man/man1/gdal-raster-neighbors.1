.\" Man page generated from reStructuredText.
.
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.TH "GDAL-RASTER-NEIGHBORS" "1" "Nov 07, 2025" "" "GDAL"
.SH NAME
gdal-raster-neighbors \- Compute the value of each pixel from its neighbors (focal statistics)
.sp
Added in version 3.12.

.SH SYNOPSIS
.INDENT 0.0
.INDENT 3.5
.sp
.EX
Usage: gdal raster neighbors [OPTIONS] <INPUT> <OUTPUT>

Compute the value of each pixel from its neighbors (focal statistics)

Positional arguments:
  \-i, \-\-input <INPUT>                                      Input raster datasets [required]
  \-o, \-\-output <OUTPUT>                                    Output raster dataset [required]

Common Options:
  \-h, \-\-help                                               Display help message and exit
  \-\-json\-usage                                             Display usage as JSON document and exit
  \-\-config <KEY>=<VALUE>                                   Configuration option [may be repeated]
  \-q, \-\-quiet                                              Quiet mode (no progress bar)

Options:
  \-f, \-\-of, \-\-format, \-\-output\-format <OUTPUT\-FORMAT>      Output format (\(dqGDALG\(dq allowed)
  \-\-co, \-\-creation\-option <KEY>=<VALUE>                    Creation option [may be repeated]
  \-\-overwrite                                              Whether overwriting existing output is allowed
                                                           Mutually exclusive with \-\-append
  \-\-append                                                 Append as a subdataset to existing output
                                                           Mutually exclusive with \-\-overwrite
  \-b, \-\-band <BAND>                                        Input band (1\-based index)
  \-\-method <METHOD>                                        Method to combine weighed source pixels. METHOD=mean|sum|min|max|stddev|median|mode [may be repeated]
  \-\-size <SIZE>                                            Neighborhood size
  \-\-kernel <KERNEL>                                        Convolution kernel(s) to apply [1.. values] [required]
  \-\-ot, \-\-datatype, \-\-output\-data\-type <OUTPUT\-DATA\-TYPE>  Output data type. OUTPUT\-DATA\-TYPE=Byte|Int8|UInt16|Int16|UInt32|Int32|UInt64|Int64|CInt16|CInt32|Float16|Float32|Float64|CFloat32|CFloat64 (default: Float64)
  \-\-nodata <NODATA>                                        Assign a specified nodata value to output bands (\(aqnone\(aq, numeric value, \(aqnan\(aq, \(aqinf\(aq, \(aq\-inf\(aq)

Advanced Options:
  \-\-if, \-\-input\-format <INPUT\-FORMAT>                      Input formats [may be repeated]
  \-\-oo, \-\-open\-option <KEY>=<VALUE>                        Open options [may be repeated]
.EE
.UNINDENT
.UNINDENT
.SH DESCRIPTION
.sp
\fBgdal raster neighbors\fP applies a
\X'tty: link https://en.wikipedia.org/wiki/Kernel_(image_processing)'\fI\%kernel (convolution matrix)\fP\X'tty: link'
and a method to compute the target pixel value from a neighbourhood of the source pixel value.
.sp
At the top edge, the values of the first row are replicated to virtually extend
the source window by a number of rows equal to the radius of the kernel. And
similarly for the bottom, left and right edges. This strategy may potentially
lead to unexpected results depending on the applied kernel.
.sp
For a given target cell, if the corresponding source value (the one at the center
of the kernel) is nodata, the resulting pixel is nodata. For other source values
in the neighborhood defined by the kernel, source nodata values are ignored.
.sp
This algorithm can be part of a \fI\%gdal pipeline\fP or \fI\%gdal raster pipeline\fP\&.
.SH OPTIONS
.sp
The following options are available:
.INDENT 0.0
.TP
.B \-f, \-\-of, \-\-format, \-\-output\-format <OUTPUT\-FORMAT>
Which output raster format to use. Allowed values may be given by
\fBgdal \-\-formats | grep raster | grep rw | sort\fP
.UNINDENT
.INDENT 0.0
.TP
.B \-\-co <NAME>=<VALUE>
Many formats have one or more optional creation options that can be
used to control particulars about the file created. For instance,
the GeoTIFF driver supports creation options to control compression,
and whether the file should be tiled.
.sp
May be repeated.
.sp
The creation options available vary by format driver, and some
simple formats have no creation options at all. A list of options
supported for a format can be listed with the
\fI\%\-\-formats\fP
command line option but the documentation for the format is the
definitive source of information on driver creation options.
See \fI\%Raster drivers\fP format
specific documentation for legal creation options for each format.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-overwrite
Allow program to overwrite existing target file or dataset.
Otherwise, by default, \fBgdal\fP errors out if the target file or
dataset already exists.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-band <BAND>
Source band number (indexing starts at one). If it is not specified, all
input bands are used.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-kernel
Convolution kernel to apply to source pixels in a neighborhood of each pixel.
.INDENT 7.0
.IP \(bu 2
either the name of a well\-known kernel, among \fBedge1\fP,
\fBedge2\fP, \fBsharpen\fP,  \fBgaussian\fP, or \fBunsharp\-masking\fP, corresponding to those
\X'tty: link https://en.wikipedia.org/wiki/Kernel_(image_processing)#Details'\fI\%kernels (convolution matrix)\fP\X'tty: link',
with the addition of:
.INDENT 2.0
.IP \(bu 2
\fBequal\fP corresponding to a kernel with all coefficients at one
kernel size can be any odd number between 3 and 99):
.sp
.ce
\ebegin{align}
    \ebegin{bmatrix} 1 & 1 & 1\e\e 1 & 1 & 1 \e\e 1 & 1 & 1 \eend{bmatrix}
\eend{align}


.ce 0
.sp
For method \fBmean\fP, this corresponds to a box blur filter.
.IP \(bu 2
\fBu\fP corresponding to an horizontal derivative with coefficients:
.sp
.ce
\ebegin{align}
    \ebegin{bmatrix} 0 & 0 & 0\e\e \-0.5 & 0 & 0.5 \e\e 0 & 0 & 0 \eend{bmatrix}
\eend{align}


.ce 0
.IP \(bu 2
\fBv\fP corresponding to a vertical derivative with coefficients:
.sp
.ce
\ebegin{align}
    \ebegin{bmatrix} 0 & \-0.5 & 0\e\e 0 & 0 & 0 \e\e 0 & 0.5 & 0 \eend{bmatrix}
\eend{align}


.ce 0
.UNINDENT
.INDENT 2.0
.INDENT 3.5
\fBedge1\fP, \fBedge2\fP, \fBsharpen\fP, \fBu\fP and \fBv\fP are only supported for a kernel size equal to 3.
.sp
\fBgaussian\fP is supported for a kernel size equal to 3 or 5.
.sp
\fBunsharp\-masking\fP is supported for a kernel size equal to 5.
.UNINDENT
.UNINDENT
.IP \(bu 2
or the values of the coefficients of the kernel as a square matrix of
width and height N, where N is an odd number, as
\fB[[val00, val01, ..., val0N],[val10, val11, ..., val1N],...,[valN0, valN1, ..., valNN]]\fP\&.
.sp
If \fI\%\-\-method\fP is set to \fBmean\fP, this has the effect of
adding the sum of the (contributing, i.e. non nodata) weighted source pixels
and dividing it by the sum of the coefficients in the kernel.
.UNINDENT
.sp
If \fI\%\-\-kernel\fP is specified several times, there will one output band for each
combination of kernel and input band.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-size <SIZE>
Size of the kernel. Odd number between 3 and 99.
.sp
\fBNOTE:\fP
.INDENT 7.0
.INDENT 3.5
Computation time is proportional to the square of the kernel size.
.UNINDENT
.UNINDENT
.sp
For kernels \fBedge1\fP, \fBedge2\fP, \fBsharpen\fP, \fBu\fP, \fBv\fP, \fBgaussian\fP, \fBequal\fP, defaults to 3.
.sp
For kernel \fBunsharp\-masking\fP, defaults to 5.
.sp
For kernels specified through their coefficient values, it is deduced from the shape of the matrix.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-method sum|mean|min|max|stddev|median|mode
Function to apply to the weighted source pixels in the neighborhood defined by the kernel.
Defaults to \fBmean\fP, except when \fI\%\-\-kernel\fP is set to \fBu\fP, \fBv\fP, \fBedge1\fP, \fBedge2\fP,
or a user defined kernel whose sum of coefficients is zero, in which case \fBsum\fP is used.
.INDENT 7.0
.IP \(bu 2
\fBsum\fP: computes the sum of the value of contributing source pixels multiplied by the corresponding weight of the kernel. This corresponds to a kernel with un\-normalized sum of coefficients.
.IP \(bu 2
\fBmean\fP: computes the average of the value of contributing source pixels multiplied by the corresponding weight of the kernel. This has the effect of normalizing kernel coefficients so their sum is one.
.IP \(bu 2
\fBmin\fP: computes the minimum of the value of contributing source pixels multiplied by the corresponding weight of the kernel
.IP \(bu 2
\fBmax\fP: computes the maximum of the value of contributing source pixels multiplied by the corresponding weight of the kernel
.IP \(bu 2
\fBstddev\fP: computes the standard deviation of the value of contributing source pixels multiplied by the corresponding weight of the kernel
.IP \(bu 2
\fBmedian\fP: computes the median of the value of contributing source pixels multiplied by the corresponding weight of the kernel
.IP \(bu 2
\fBmode\fP (majority): computes the most frequent of the value of contributing source pixels multiplied by the corresponding weight of the kernel
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B \-\-nodata
Set the NoData value for the output dataset. May be set to \fBnone\fP to leave the NoData value undefined. If
\fI\%\-\-nodata\fP is not specified, \fBgdal raster neighbors\fP will use a NoData value from the first
source dataset to have one.
.UNINDENT
.SH GDALG OUTPUT (ON-THE-FLY / STREAMED DATASET)
.sp
This program supports serializing the command line as a JSON file using the \fBGDALG\fP output format.
The resulting file can then be opened as a raster dataset using the
\fI\%GDALG: GDAL Streamed Algorithm\fP driver, and apply the specified pipeline in a on\-the\-fly /
streamed way.
.SH EXAMPLES
.SS Example 1: Compute the horizontal and vertical derivative of a single\-band raster
.INDENT 0.0
.INDENT 3.5
.sp
.EX
gdal raster neighbors \-\-kernel u \-\-kernel v in.tif uv.tif
.EE
.UNINDENT
.UNINDENT
.SS Example 2: Compute the average value around each pixel in a 3x3 neighborhood
.INDENT 0.0
.INDENT 3.5
.sp
.EX
gdal raster neighbors \-\-kernel equal \-\-method mean in.tif mean.tif
.EE
.UNINDENT
.UNINDENT
.SS Example 3: Compute the maximum value around each pixel in a 5x5 neighborhood
.INDENT 0.0
.INDENT 3.5
.sp
.EX
gdal raster neighbors \-\-kernel equal \-\-size 5 \-\-method max in.tif max.tif
.EE
.UNINDENT
.UNINDENT
.SS Example 4: Compute a sharpen filter of a single\-band raster, by manually specifying the kernel coefficients.
.INDENT 0.0
.INDENT 3.5
.sp
.EX
gdal raster neighbors \(dq\-\-kernel=[[0,\-1,0],[\-1,5,\-1],[0,\-1,0]]\(dq in.tif sharpen.tif
.EE
.UNINDENT
.UNINDENT
.SH AUTHOR
Even Rouault <even.rouault@spatialys.com>
.SH COPYRIGHT
1998-2025
.\" Generated by docutils manpage writer.
.
