.\" Man page generated from reStructuredText.
.
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.TH "GDAL-RASTER-CALC" "1" "Nov 07, 2025" "" "GDAL"
.SH NAME
gdal-raster-calc \- Perform pixel-wise calculations on a raster
.sp
Added in version 3.11.

.SH SYNOPSIS
.INDENT 0.0
.INDENT 3.5
.sp
.EX
Usage: gdal raster calc [OPTIONS] <INPUTS>... <OUTPUT>

Perform raster algebra

Positional arguments:
  \-i, \-\-input <INPUTS>                                     Input raster datasets [1.. values] [required]
  \-o, \-\-output <OUTPUT>                                    Output raster dataset [required]

Common Options:
  \-h, \-\-help                                               Display help message and exit
  \-\-json\-usage                                             Display usage as JSON document and exit
  \-\-config <KEY>=<VALUE>                                   Configuration option [may be repeated]
  \-q, \-\-quiet                                              Quiet mode (no progress bar)

Options:
  \-f, \-\-of, \-\-format, \-\-output\-format <OUTPUT\-FORMAT>      Output format (\(dqGDALG\(dq allowed)
  \-\-co, \-\-creation\-option <KEY>=<VALUE>                    Creation option [may be repeated]
  \-\-overwrite                                              Whether overwriting existing output is allowed
                                                           Mutually exclusive with \-\-append
  \-\-append                                                 Append as a subdataset to existing output
                                                           Mutually exclusive with \-\-overwrite
  \-\-ot, \-\-datatype, \-\-output\-data\-type <OUTPUT\-DATA\-TYPE>  Output data type. OUTPUT\-DATA\-TYPE=Byte|Int8|UInt16|Int16|UInt32|Int32|UInt64|Int64|CInt16|CInt32|Float16|Float32|Float64|CFloat32|CFloat64
  \-\-no\-check\-srs                                           Do not check consistency of input spatial reference systems
  \-\-no\-check\-extent                                        Do not check consistency of input extents
  \-\-propagate\-nodata                                       Whether to set pixels to the output NoData value if any of the input pixels is NoData
  \-\-calc <CALC>                                            Expression(s) to evaluate [1.. values] [required]
  \-\-dialect <DIALECT>                                      Expression dialect. DIALECT=muparser|builtin (default: muparser)
  \-\-flatten                                                Generate a single band output raster per expression, even if input datasets are multiband
  \-\-nodata <NODATA>                                        Assign a specified nodata value to output bands (\(aqnone\(aq, numeric value, \(aqnan\(aq, \(aqinf\(aq, \(aq\-inf\(aq)

Advanced Options:
  \-\-if, \-\-input\-format <INPUT\-FORMAT>                      Input formats [may be repeated]
  \-\-oo, \-\-open\-option <KEY>=<VALUE>                        Open options [may be repeated]
.EE
.UNINDENT
.UNINDENT
.SH DESCRIPTION
.sp
\fBgdal raster calc\fP performs pixel\-wise calculations on one or more input GDAL datasets. Calculations
can be performed eagerly, writing results to a conventional raster format,
or lazily, written as a set of derived bands in a \fI\%VRT (Virtual Dataset)\fP\&.
.sp
The list of input GDAL datasets can be specified at the end
of the command line or put in a text file (one input per line) for very long lists.
If more than one input dataset is used, it should be prefixed with a name by which it
will be referenced in the calculation, e.g. \fBA=my_data.tif\fP\&. (If a single dataset is
used, it will be referred to with the variable \fBX\fP in formulas.)
.sp
Starting with GDAL 3.12, it is also possible to use a \fI\%VRT C++ pixel function\fP
(such a \fBsum\fP, \fBmean\fP, \fBmin\fP, \fBmax\fP) by specifying \fI\%\-\-dialect\fP to
\fBbuiltin\fP\&.
.sp
The inputs should have the same spatial reference system and should cover the same spatial extent but are not required to have the same
spatial resolution. The spatial extent check can be disabled with \fI\%\-\-no\-check\-extent\fP,
in which case the inputs must have the same dimensions. The spatial reference system check can be
disabled with \fI\%\-\-no\-check\-srs\fP\&.
.sp
Since GDAL 3.12, this algorithm can be part of a \fI\%gdal pipeline\fP or \fI\%gdal raster pipeline\fP\&.
.sp
The following options are available:
.INDENT 0.0
.TP
.B \-f, \-\-of, \-\-format, \-\-output\-format <OUTPUT\-FORMAT>
Which output raster format to use. Allowed values may be given by
\fBgdal \-\-formats | grep raster | grep rw | sort\fP
.UNINDENT
.INDENT 0.0
.TP
.B \-\-co <NAME>=<VALUE>
Many formats have one or more optional creation options that can be
used to control particulars about the file created. For instance,
the GeoTIFF driver supports creation options to control compression,
and whether the file should be tiled.
.sp
May be repeated.
.sp
The creation options available vary by format driver, and some
simple formats have no creation options at all. A list of options
supported for a format can be listed with the
\fI\%\-\-formats\fP
command line option but the documentation for the format is the
definitive source of information on driver creation options.
See \fI\%Raster drivers\fP format
specific documentation for legal creation options for each format.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-overwrite
Allow program to overwrite existing target file or dataset.
Otherwise, by default, \fBgdal\fP errors out if the target file or
dataset already exists.
.UNINDENT
.INDENT 0.0
.TP
.B \-i [<name>=]<input>
Select an input dataset to be processed. If more than one input dataset is provided,
each dataset must be prefixed with a name to which it will will be referenced in \fI\%\-\-calc\fP\&.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-calc
An expression to be evaluated using the \X'tty: link https://beltoforion.de/en/muparser'\fI\%muparser\fP\X'tty: link' math parser library.
The expression may refer to individual bands of each input (e.g., \fBX[1] + 3\fP) or it may be applied to all bands
of an input (\fBX + 3\fP).
.sp
There are two methods by which an expression may be applied to multiple bands. In the default method, the expression is
applied to each band individually, resulting in one output band for each input band. For example, with a three\-band
input \fBX\fP, the expression \fB\-\-calc \(dqX+3\(dq\fP would be expanded into \fB\-\-calc \(dqX[1]+3\(dq \-\-calc \(dqX[2]+3\(dq \-\-calc \(dqX[3]+3\(dq\fP\&.
If the expression contains a reference to all bands of multiple inputs, those inputs must either have the same
number of bands, or a single band. For example, if inputs \fBA\fP and \fBB\fP each have three bands, and input \fBC\fP has
a single band, then the argument \fB\-\-calc \(dqA + B + C\(dq\fP is equivalent to
\fB\-\-calc \(dqA[1] + B[1] + C[1]\(dq \-\-calc \(dqA[2] + B[2] + C[1]\(dq \-\-calc \(dqA[3] + B[3] + C[1]\(dq\fP\&.
Similarly, \fB\-\-calc \(dqsum(A,B,C)\(dq\fP would be expanded to
\fB\-\-calc \(dqsum(A[1], B[1], C[1]\(dq \-\-calc \(dqsum(A[2], B[2], C[1])\(dq \-\-calc \(dqsum(A[3], B[3], C[1])\(dq\fP\&.
.sp
In the second method, which is enabled with \fI\%\-\-flatten\fP, aggregate functions (\fBsum\fP, \fBavg\fP, \fBmin\fP, and \fBmax\fP)
invoked on multiple bands will be applied to all bands in aggregate. In this case, \fBsum(A)\fP is expanded into \fBsum(A[1], A[2], A[3])\fP,
and \fBsum(A,C)\fP is expanded into \fBsum(A[1], A[2], A[3], C[1])\fP\&. If the expression consists _only_ of aggregate functions,
this will produce a single output band no matter how many input bands are present. However, if the expression contains
a non\-aggregate reference to all bands of an input, then one output band will still be produced for each input band. A simple
example is the expression \fBA / sum(A)\fP, which would produce an N\-band raster where each output band contains the input band\(aqs
fraction of the total.
.sp
Multiple calculations may be specified; output band(s) will be produced for each expression in the order they
are provided.
.sp
Input rasters will be converted to 64\-bit floating point numbers before performing calculations.
.sp
Starting with GDAL 3.12, it is also possible to use a \fI\%VRT C++ pixel function\fP
(such a \fBsum\fP, \fBmean\fP, \fBmin\fP, \fBmax\fP) by specifying \fI\%\-\-dialect\fP to
\fBbuiltin\fP\&.
Arguments to functions are passed within parentheses, like \fBsum(k=1)\fP,
\fBmin(propagateNoData=true)\fP or \fBinterpolate_linear(t0=1,dt=1,t=10)\fP\&.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-dialect muparser|builtin
Added in version 3.12.

.sp
Specify the expression engine used to interpret the value of \fI\%\-\-calc\fP\&.
The default is \fBmuparser\fP\&.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-flatten
Added in version 3.12.

.sp
Generate a single band output raster per expression, even if input datasets are multiband.
.sp
For the default muparser dialect, using the name of an input raster (let\(aqs say A)
is equivalent to \fBA[1],A[2],...,A[n]\fP\&. Such syntax works with the
\fBmin\fP, \fBmax\fP, \fBsum\fP and \fBavg\fP muparser functions.
.sp
For example, let\(aqs consider 2 rasters A and B with 3bands each, then
\fB\-\-flatten \-\-calc \(dqavg(A)\-avg(B)\(dq\fP is equivalent to \fB\-\-calc \(dqavg(A[1],A[2],A[3])\-avg(B[1],B[2],B[3])\(dq\fP
.sp
And \fB\-\-flatten \-\-dialect=builtin \-\-calc mean\fP will compute a single band
with the average of all 4 input bands.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-no\-check\-extent
Do not verify that the input rasters have the same spatial extent. The input rasters will instead be required to
have the same dimensions. The geotransform of the first input will be assigned to the output.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-no\-check\-srs
Do not check the spatial reference systems of the inputs for consistency. All inputs will be assumed to have the
spatial reference system of the first input, and this spatial reference system will be used for the output.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-nodata
Added in version 3.12.

.sp
Set the NoData value for the output dataset. May be set to \(dqnone\(dq to leave the NoData value undefined. If
\fI\%\-\-nodata\fP is not specified, \fBgdal raster calc\fP will use a NoData value from the first
source dataset to have one.
.UNINDENT
.INDENT 0.0
.TP
.B \-\-propagate\-nodata
Added in version 3.12.

.sp
If set, a NoData value in any input dataset used an in expression will cause the output value to be NoData.
.UNINDENT
.SH GDALG OUTPUT (ON-THE-FLY / STREAMED DATASET)
.sp
This program supports serializing the command line as a JSON file using the \fBGDALG\fP output format.
The resulting file can then be opened as a raster dataset using the
\fI\%GDALG: GDAL Streamed Algorithm\fP driver, and apply the specified pipeline in a on\-the\-fly /
streamed way.
.SH EXAMPLES
.SS Example 1: Per\-band sum of three files
.INDENT 0.0
.INDENT 3.5
.sp
.EX
gdal raster calc \-i \(dqA=file1.tif\(dq \-i \(dqB=file2.tif\(dq \-i \(dqC=file3.tif\(dq \-\-calc \(dqA+B+C\(dq \-o out.tif
.EE
.UNINDENT
.UNINDENT
.SS Example 2: Per\-dataset average of all bands of each dataset
.INDENT 0.0
.INDENT 3.5
.sp
.EX
gdal raster calc \-i \(dqA=file1.tif\(dq \-i \(dqB=file2.tif\(dq \-i \(dqC=file3.tif\(dq \-\-flatten \-\-calc \(dqavg(A)\(dq \-\-calc \(dqavg(B)\(dq \-\-calc \(dqavg(C)\(dq \-o out.tif
.EE
.UNINDENT
.UNINDENT
.SS Example 3: Per\-band maximum of three files
.INDENT 0.0
.INDENT 3.5
.sp
.EX
gdal raster calc \-i \(dqA=file1.tif\(dq \-i \(dqB=file2.tif\(dq \-i \(dqC=file3.tif\(dq \-\-calc \(dqmax(A,B,C)\(dq \-o out.tif
.EE
.UNINDENT
.UNINDENT
.SS Example 4: Setting values of zero and below to NaN
.INDENT 0.0
.INDENT 3.5
.sp
.EX
gdal raster calc \-i \(dqA=input.tif\(dq \-o result.tif \-\-calc=\(dqA > 0 ? A : NaN\(dq
.EE
.UNINDENT
.UNINDENT
.SS Example 5: Compute the average (as a single band) of all bands of two input datasets
.INDENT 0.0
.INDENT 3.5
.sp
.EX
gdal raster calc \-i A=input1.tif \-i B=input2.tif \-o result.tif \-\-flatten \-\-calc=mean \-\-dialect=builtin
.EE
.UNINDENT
.UNINDENT
.SH AUTHOR
Dan Baston <dbaston@gmail.com>
.SH COPYRIGHT
1998-2025
.\" Generated by docutils manpage writer.
.
